'use strict';

var _fs = require('fs');

var _fs2 = _interopRequireDefault(_fs);

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _electronCompile = require('electron-compile');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function findPackageJson(initScript) {
  if (initScript === '/' || initScript.match(/^[A-Za-z]:$/)) {
    throw new Error("Can't find package.json");
  }

  // Walk up the parent directories until we find package.json. Make sure that
  // we're not actually stumbling upon a parent npm package
  var ret = _path2.default.join(initScript, 'package.json');
  if (_fs2.default.statSyncNoException(ret) && !_path2.default.resolve(_path2.default.dirname(ret), '..').match(/[\\\/]node_modules$/i)) {
    return ret;
  }

  return findPackageJson(_path2.default.dirname(initScript));
}

function main() {
  var initScript = _path2.default.resolve(process.argv[2]);
  var packageJson = findPackageJson(initScript);

  // Reconstitute the original arguments
  var args = process.argv.slice(2);
  process.argv = [process.argv[0]].concat(args);

  (0, _electronCompile.init)(_path2.default.dirname(packageJson), initScript);
}

main();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lczYtaW5pdC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUVBLFNBQVMsZUFBVCxDQUF5QixVQUF6QixFQUFxQztBQUNuQyxNQUFJLGVBQWUsR0FBZixJQUFzQixXQUFXLEtBQVgsQ0FBaUIsYUFBakIsQ0FBMUIsRUFBMkQ7QUFDekQsVUFBTSxJQUFJLEtBQUosQ0FBVSx5QkFBVixDQUFOO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBLE1BQUksTUFBTSxlQUFLLElBQUwsQ0FBVSxVQUFWLEVBQXNCLGNBQXRCLENBQVY7QUFDQSxNQUFJLGFBQUcsbUJBQUgsQ0FBdUIsR0FBdkIsS0FBK0IsQ0FBQyxlQUFLLE9BQUwsQ0FBYSxlQUFLLE9BQUwsQ0FBYSxHQUFiLENBQWIsRUFBZ0MsSUFBaEMsRUFBc0MsS0FBdEMsQ0FBNEMsc0JBQTVDLENBQXBDLEVBQXlHO0FBQ3ZHLFdBQU8sR0FBUDtBQUNEOztBQUVELFNBQU8sZ0JBQWdCLGVBQUssT0FBTCxDQUFhLFVBQWIsQ0FBaEIsQ0FBUDtBQUNEOztBQUVELFNBQVMsSUFBVCxHQUFnQjtBQUNkLE1BQUksYUFBYSxlQUFLLE9BQUwsQ0FBYSxRQUFRLElBQVIsQ0FBYSxDQUFiLENBQWIsQ0FBakI7QUFDQSxNQUFJLGNBQWMsZ0JBQWdCLFVBQWhCLENBQWxCOztBQUVBO0FBQ0EsTUFBSSxPQUFPLFFBQVEsSUFBUixDQUFhLEtBQWIsQ0FBbUIsQ0FBbkIsQ0FBWDtBQUNBLFVBQVEsSUFBUixHQUFlLENBQUMsUUFBUSxJQUFSLENBQWEsQ0FBYixDQUFELEVBQWtCLE1BQWxCLENBQXlCLElBQXpCLENBQWY7O0FBRUEsNkJBQUssZUFBSyxPQUFMLENBQWEsV0FBYixDQUFMLEVBQWdDLFVBQWhDO0FBQ0Q7O0FBRUQiLCJmaWxlIjoiZXM2LWluaXQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQge2luaXR9IGZyb20gJ2VsZWN0cm9uLWNvbXBpbGUnO1xuXG5mdW5jdGlvbiBmaW5kUGFja2FnZUpzb24oaW5pdFNjcmlwdCkge1xuICBpZiAoaW5pdFNjcmlwdCA9PT0gJy8nIHx8IGluaXRTY3JpcHQubWF0Y2goL15bQS1aYS16XTokLykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBmaW5kIHBhY2thZ2UuanNvblwiKTtcbiAgfVxuXG4gIC8vIFdhbGsgdXAgdGhlIHBhcmVudCBkaXJlY3RvcmllcyB1bnRpbCB3ZSBmaW5kIHBhY2thZ2UuanNvbi4gTWFrZSBzdXJlIHRoYXRcbiAgLy8gd2UncmUgbm90IGFjdHVhbGx5IHN0dW1ibGluZyB1cG9uIGEgcGFyZW50IG5wbSBwYWNrYWdlXG4gIGxldCByZXQgPSBwYXRoLmpvaW4oaW5pdFNjcmlwdCwgJ3BhY2thZ2UuanNvbicpXG4gIGlmIChmcy5zdGF0U3luY05vRXhjZXB0aW9uKHJldCkgJiYgIXBhdGgucmVzb2x2ZShwYXRoLmRpcm5hbWUocmV0KSwgJy4uJykubWF0Y2goL1tcXFxcXFwvXW5vZGVfbW9kdWxlcyQvaSkpIHtcbiAgICByZXR1cm4gcmV0O1xuICB9XG5cbiAgcmV0dXJuIGZpbmRQYWNrYWdlSnNvbihwYXRoLmRpcm5hbWUoaW5pdFNjcmlwdCkpO1xufVxuXG5mdW5jdGlvbiBtYWluKCkge1xuICBsZXQgaW5pdFNjcmlwdCA9IHBhdGgucmVzb2x2ZShwcm9jZXNzLmFyZ3ZbMl0pO1xuICBsZXQgcGFja2FnZUpzb24gPSBmaW5kUGFja2FnZUpzb24oaW5pdFNjcmlwdCk7XG5cbiAgLy8gUmVjb25zdGl0dXRlIHRoZSBvcmlnaW5hbCBhcmd1bWVudHNcbiAgbGV0IGFyZ3MgPSBwcm9jZXNzLmFyZ3Yuc2xpY2UoMik7XG4gIHByb2Nlc3MuYXJndiA9IFtwcm9jZXNzLmFyZ3ZbMF1dLmNvbmNhdChhcmdzKTtcbiAgXG4gIGluaXQocGF0aC5kaXJuYW1lKHBhY2thZ2VKc29uKSwgaW5pdFNjcmlwdClcbn1cblxubWFpbigpXG4iXX0=